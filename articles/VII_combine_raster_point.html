<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VII. Putting It All Together • rnpn</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="VII. Putting It All Together">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rnpn</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/I_introduction.html">I. Introduction</a>
    </li>
    <li>
      <a href="../articles/II_status_intensity.html">II. Status and Intensity Data</a>
    </li>
    <li>
      <a href="../articles/III_individual_phenometrics.html">III. Individual Phenometrics</a>
    </li>
    <li>
      <a href="../articles/IV_site_phenometrics.html">IV. Site Phenometrics</a>
    </li>
    <li>
      <a href="../articles/V_magnitude_phenometrics.html">V. Magnitude Phenometrics</a>
    </li>
    <li>
      <a href="../articles/VI_geospatial.html">VI. USA-NPN Geospatial Data</a>
    </li>
    <li>
      <a href="../articles/VII_combine_raster_point.html">VII. Putting It All Together</a>
    </li>
    <li>
      <a href="../articles/VIII_data_cleaning.html">VIII. Data Cleaning</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/usa-npn/rnpn/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>VII. Putting It All Together</h1>
                        <h4 data-toc-skip class="author">Lee Marsh</h4>
            
            <h4 data-toc-skip class="date">2025-06-24</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/usa-npn/rnpn/blob/master/vignettes/VII_combine_raster_point.Rmd" class="external-link"><code>vignettes/VII_combine_raster_point.Rmd</code></a></small>
      <div class="hidden name"><code>VII_combine_raster_point.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/usa-npn/rnpn" class="external-link">rnpn</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="combine-point-and-raster-data">Combine Point and Raster Data<a class="anchor" aria-label="anchor" href="#combine-point-and-raster-data"></a>
</h2>
<p>Observational and gridded data can be visualized or analyzed together
for a variety of purposes. Users may want to identify spatial patterns
in the alignment of dogwood bloom and the Spring Index bloom model. The
current year’s lilac leaf out observations may be compared to the 30
year average lilac sub-model of the spring index to see how well the
model predicts the observations.</p>
<p>This example shows several data access calls to assemble
observational and gridded data.</p>
<p>Option 1: You can add a parameter to an observational data call to
additionally get a gridded layer value for each observation
location/date. Note that if you don’t specify which sub model of the
Spring Index you want, you will get the SI-x Average layers.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/npn_download_site_phenometrics.html">npn_download_site_phenometrics</a></span><span class="op">(</span></span>
<span>  request_source <span class="op">=</span> <span class="st">'Your Name Here'</span>, </span>
<span>  years <span class="op">=</span> <span class="st">'2013'</span>,</span>
<span>  num_days_quality_filter <span class="op">=</span> <span class="st">'30'</span>, </span>
<span>  species_ids <span class="op">=</span> <span class="st">'35'</span>,</span>
<span>  phenophase_ids <span class="op">=</span> <span class="st">'373'</span>, </span>
<span>  download_path <span class="op">=</span> <span class="st">'cl_lilac_data_2013_SIxLeaf.csv'</span>,</span>
<span>  six_leaf_layer <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  six_sub_model <span class="op">=</span> <span class="st">'lilac'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>If you want to append raster data other than Spring Index, Leaf
values, there’s alternative boolean flags that can be set, including
six_bloom_layer for Spring Index, Bloom data, and agdd_layer. Instead of
TRUE or FALSE agdd_layer takes 32 or 50 and will correlate each data
point with the corresponding AGDD value for the given date using either
32 or 50 base temperature.</p>
<p>Option 2: You can create a combined plot of observational data with
modeled/raster data.</p>
<p>Building on the approach for accessing point data from earlier
vignettes describing Individual Phenometrics and getting raster data, we
can access and plot these products together. In this example, we will
look at how well cloned lilac leaf out observations in 2018 are
predicted by the lilac leaf sub model of the Spring Index.</p>
<div class="section level3">
<h3 id="step-1-get-the-data">Step 1: Get the data<a class="anchor" aria-label="anchor" href="#step-1-get-the-data"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LilacLeaf2018</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/npn_download_geospatial.html">npn_download_geospatial</a></span><span class="op">(</span></span>
<span>  <span class="st">'si-x:lilac_leaf_ncep_historic'</span>, </span>
<span>  <span class="st">'2018-01-01'</span>, </span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">LilacLeaf2018Obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/npn_download_individual_phenometrics.html">npn_download_individual_phenometrics</a></span><span class="op">(</span></span>
<span>  request_source <span class="op">=</span> <span class="st">'Your Name Here'</span>, </span>
<span>  years <span class="op">=</span> <span class="st">'2018'</span>,</span>
<span>  species_ids <span class="op">=</span> <span class="st">'35'</span>,</span>
<span>  phenophase_ids <span class="op">=</span> <span class="st">'373'</span> </span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-2-preparing-the-data">Step 2: Preparing the data<a class="anchor" aria-label="anchor" href="#step-2-preparing-the-data"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># coords &lt;- LilacLeaf2018Obs[ , c("longitude", "latitude")]</span></span>
<span><span class="co"># data &lt;- as.data.frame(LilacLeaf2018Obs$first_yes_doy)</span></span>
<span></span>
<span><span class="va">crs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="st">"+proj=utm +zone=18 +datum=WGS84 +units=m +no_defs </span></span>
<span><span class="st">                 +ellps=WGS84 +towgs84=0,0,0"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">LL_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span></span>
<span>  <span class="va">LilacLeaf2018Obs</span>,</span>
<span>  coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>,</span>
<span>  crs <span class="op">=</span> <span class="va">crs</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="step-3-define-style-options-and-create-graph">Step 3: Define style options and create graph<a class="anchor" aria-label="anchor" href="#step-3-define-style-options-and-create-graph"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html" class="external-link">brewer.pal</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">9</span>, name <span class="op">=</span> <span class="st">"OrRd"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">LilacLeaf2018</span>, </span>
<span>  col <span class="op">=</span> <span class="va">my.palette</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"2018 Observed and Predicted Lilac Leaf Out"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">LL_sf</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Lilac Obs"</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  bg <span class="op">=</span> <span class="va">my.palette</span>,</span>
<span>  col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">125.0208</span>, <span class="op">-</span><span class="fl">66.47917</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24.0625</span>, <span class="fl">49.9375</span><span class="op">)</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span></span>
<span>  <span class="st">"bottomright"</span>, </span>
<span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cloned Lilac Leaf Out Observations"</span><span class="op">)</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  bg <span class="op">=</span> <span class="st">'white'</span>,</span>
<span>  col <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>  bty <span class="op">=</span> <span class="st">"n"</span>, </span>
<span>  cex <span class="op">=</span> <span class="fl">0.8</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="figures/7-plot.png" width="50%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jeff Switzer, Scott Chamberlain, Lee Marsh, Kevin Wong, Eric R Scott.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
